<!DOCTYPE html>
<html>
<head>
<script src="/socket.io/socket.io.js"></script>
<script>
	var socket = io();
	socket.on('terminal output', function(data) {
		var currentHTML = document.getElementById("terminal-output").innerHTML;
		document.getElementById("terminal-output").innerHTML = currentHTML + data;
		document.getElementById("terminal-output").scrollTop = document.getElementById("terminal-output").scrollHeight
	});
	

	socket.on('companion refs', function(data) {
		console.log(data);
		var select = document.getElementById('tags');
		var lines = data.trim().split('\n');
		lines.forEach(function(line) {
			var option = document.createElement('option');
			option.value = line;
			option.innerHTML = line;
			select.appendChild(option);
			console.log(line);
		});
	});

	function updateCompanion() {
		socket.emit('update companion', document.getElementById('tags').value);
	}
	
	function updatePixhawkDev() {
		updatePixhawk('dev');
	};
	
	function updatePixhawkBeta() {
		
		updatePixhawk('beta')
	}
	
	function updatePixhawkStable() {
		updatePixhawk('stable')
	}
	

	function updatePixhawk(option) {
		socket.emit('update pixhawk' {
			'option' : option
		});
	}
	

	socket.emit('get companion refs');
</script>
</head>
<div>
	<h3>Companion Update</h3>
	<div>
		<select id="tags"></select>
		<button onclick="updateCompanion()">Update Companion</button>
	</div>
</div>
<div>
	<h3>Pixhawk Update</h3>
		<div>
			<button onclick="updatePixhawkDev()">Development</button>
			<button onclick="updatePixhawkBeta()">Beta</button>
			<button onclick="updatePixhawkStable()">Stable</button>
		</div>
</div>
<div>
	<textarea rows="8" cols="80" id="terminal-output"></textarea>
</div>
<div>
	<a href="/reboot"><button>Reboot</button></a>
	<a href="/shutdown"><button>Shutdown</button></a>
	<a href="/routing"><button>Routing</button></a>
	<a href="/network"><button>Network</button></a>
</div>
</html>