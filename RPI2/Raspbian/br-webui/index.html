<!DOCTYPE html>
<html>
<head>
    <script src="/socket.io/socket.io.js"></script>
    <script>
		var networking = io('/networking');
	
		networking.on('wifi aps', function(data) {
			
			console.log('got wifi aps')
			var select = document.getElementById("ssid");
			while (select.hasChildNodes()) {
				select.removeChild(select.lastChild);
			}
			data.forEach(function(line) {
				var option = document.createElement('option');
				option.value = line;
				option.innerHTML = line;
				select.appendChild(option);
			});
		});
	
		networking.on('internet status', function(data) {
			console.log('got internet status')
			console.log(data);
			var statusIndicator = document.getElementById("internet-status");
			statusIndicator.innerHTML = data;
		});
	
		networking.on('wifi status', function(data) {
			console.log('got wifi status')
			console.log(data);
			var statusIndicator = document.getElementById("wifi-status");
			statusIndicator.innerHTML = data;
		});
	
		function joinNetwork() {
			var select = document.getElementById("ssid");
			var ssid = select.options[select.selectedIndex].text;
			networking.emit('join network', {
				"ssid" : ssid,
				"password" : document.getElementById('password').value
			});
		};
		
		networking.emit('get internet status');
		networking.emit('get wifi status');
		networking.emit('get wifi aps');
		
		setInterval(function() {
			networking.emit('get internet status');
		}, 3000);
		
		setInterval(function() {
			networking.emit('get wifi status');
		}, 3000);
		
		setInterval(function() {
			networking.emit('get wifi aps');
		}, 6000);
	
	</script>
</head>
<div>
	<h1>Network Setup</h1>
</div>
<div>
	<h3>WiFi Status:</h3>
	<strong id="wifi-status">Pending</strong>
</div>
<div>
	<h3>Internet Status:</h3>
	<div id="internet-status">Pending</div>
</div>
<div>
	<h3>
		WiFi Network Setup:   </h3>
		<div>
			<h5>WiFi SSID:</h5>
		</div>
		<div>
			<select id="ssid" style="width: 200px;"></select>
		</div>
		<div>
			<h5>Password:</h5>
		</div>
		<div>
			<input id="password" type="password" style="width: 200px;" />
			<button onclick="joinNetwork()">Join Network</button>
		</div>

</div>
<div>
	<a href="/system"><button>System</button></a>
	<a href="/routing"><button>Routing</button></a>
</div>
</html>